# Population data
population_data <- c(0.36703622,0.083820107,0.407811207,0.623723315,0.122541081,0.664811927,
                     0.808628649,0.831596406,0.584586786,0.781170812,0.705272944,0.681978669,
                     0.912648857,0.183692384,0.879385531,0.898161894,0.704902306,0.363847071,
                     0.682949038,0.178318563,0.914322802,0.22139028,0.584959799,0.025899218,
                     0.759413757,0.290838373,0.344625872,0.146728159,0.434259845,0.825635747,
                     0.877437676,0.4121087,0.264382427,0.685754176,0.660046626,0.756373998,
                     0.384730741,0.024426668,0.933247597,0.459935254,0.860564122,0.843750438,
                     0.837812653,0.368538935,0.365608146,0.598692138,0.645100451,0.286170915,
                     0.100633319,0.020493073,0.144519054,0.323566736,0.032879142,0.7126614,
                     0.431015912,0.39325928,0.089865637,0.80678593,0.901769572,0.800217984,
                     0.114374705,0.165539935,0.77269107,0.368828581,0.86794168,0.611204236,
                     0.240452875,0.796184467,0.532539127,0.197091594,0.841097566,0.216167751,
                     0.5847364,0.239675145,0.878289601,0.619612568,0.140479471,0.227472005,
                     0.763691489,0.847116022,0.538683451,0.873189121,0.922359841,0.291103743,
                     0.485815964,0.382886597,0.923060351,0.91387604,0.713451685,0.340681564,
                     0.329327118,0.767346548,0.772622881,0.341967221,0.325087601,0.394353787,
                     0.54421423,0.682233395,0.804229253,0.454378797,2.421196534,0.371857433,
                     0.875098508,1.021057012,0.619550335,0.338184159,0.683179917,1.571884551,
                     1.026729685,0.591665419,1.370706086,1.053699246,1.512267476,1.240229648,
                     0.71443175,0.939191563,1.271251823,0.659018473,0.428495901,1.349718936,
                     0.522038932,0.55918501,0.981591816,0.187062815,1.718375867,0.689610544,
                     1.191933503,0.580318667,0.330186751,0.884516804,0.483936346,0.295392129,
                     0.63092201,2.477658446,0.37584744,0.428355737,0.437121059,1.13697221,
                     1.373810178,0.694163441,0.338601675,0.291954421,2.238518937,0.283135996,
                     0.323399296,0.425145545,0.665178714,1.067177232,0.504847145,1.16451887,
                     0.895035507,0.488398083,0.2554066,0.866292414,0.77941821,1.082718566,
                     0.428597469,1.152256344,1.877240132,0.882372417,1.992086865,0.854710099,
                     2.117402459,0.266036504,0.91243438,0.579854938,1.015080526,0.315305921,
                     0.311014909,0.544814142,0.327767061,0.723510655,0.513791839,0.909560467,
                     0.4772203,0.40418277,0.604362619,0.883781655,1.637588509,0.648991627,
                     0.551750127,0.906466141,0.591294142,0.283921341,0.469263791,1.159600849,
                     0.1631744,0.824793124,1.494246925,1.250664381,0.98279834,1.207382735,
                     0.507344888,0.612764137,0.888498034,0.549750492,1.586965382,0.504461532,
                     0.618923392,1.379431639)

# Number of iterations
num_iterations <- 1000

# Initialize vectors to store results
sample_means <- matrix(NA, nrow = num_iterations, ncol = 30)
sample_variances <- matrix(NA, nrow = num_iterations, ncol = 30)

# Set seed for reproducibility
set.seed(123)

# Loop over sample sizes
for (sample_size in 1:30) {
   # Loop over iterations
   for (iter in 1:num_iterations) {
      # Randomly sample from the population
      sample_data <- sample(population_data, size = sample_size, replace = TRUE)
      
      # Calculate sample mean and variance
      sample_means[iter, sample_size] <- mean(sample_data)
      sample_variances[iter, sample_size] <- var(sample_data)
   }
}

# Create figures
par(mfrow = c(2, 1), mar = c(4, 4, 2, 2))  # 2 rows, 1 column

# Plot sample means
plot(1:30, colMeans(sample_means, na.rm = TRUE), type = "l", xlab = "Sample Size", ylab = "Sample Mean", main = "Effect of Sample Size on Sample Mean")

# Plot sample variances
plot(1:30, colMeans(sample_variances, na.rm = TRUE), type = "l", xlab = "Sample Size", ylab = "Sample Variance", main = "Effect of Sample Size on Sample Variance")
